= render layout: 'form_wrapper', locals: { heading: t('sign_up_page_heading'),
  intro_text: t('sign_up_page_ask_have_account') + " #{link_to t('shared_links_login'), new_user_session_path, data: { turbo: false }}." } do

  = form_for(resource, as: resource_name, url: registration_path(resource_name), data: { turbo: false }) do |f|

    = render 'devise/shared/error_messages', resource: resource

    - if Settings.recaptcha_enabled?
      - if flash[:recaptcha_error].present?
        = render layout: 'field_wrapper', locals: { pb: 'pb-0' } do
          .alert.alert-warning
            = flash[:recaptcha_error]

      = recaptcha_v3(action: 'signup')

    -#
      Avoid "timeout-or-duplicate" recaptcha errors when a
      user takes more than two minutes to fill out the form
    :javascript
      setInterval(() => executeRecaptchaForSignup(), 110000)

    = render layout: 'field_wrapper' do
      = f.label t('sign_up_page_email_label')
      = f.email_field :email, autofocus: true, autocomplete: 'email', class: 'form-control'
      .small.form-text.text-muted=t('sign_up_page_enter_email')

    = render layout: 'field_wrapper' do
      = f.label +(t('sign_up_page_name_label'))
      = f.text_field :name, autofill: 'off', autocomplete: 'off', class: 'form-control'
      .small.form-text.text-muted=t('sign_up_page_enter_name')

    = render layout: 'field_wrapper' do
      = f.label +(t('sign_up_page_username_label'))
      = f.text_field :username, autofocus: true, autofill: 'off', autocomplete: 'off', class: 'form-control'
      .small.form-text.text-muted=t('sign_up_page_enter_username')

    = render layout: 'field_wrapper' do
      = f.label +(t('sign_up_page_password_label'))
      = f.password_field :password, autocomplete: 'new-password', class: 'form-control'
      .small.form-text.text-muted #{Settings.minimum_password_length} #{t('sign_up_page_password_hint')}

    = render layout: 'field_wrapper' do
      = f.label +(t('sign_up_page_password_confirm_label'))
      = f.password_field :password_confirmation, autocomplete: 'new-password', class: 'form-control'
      .small.form-text.text-muted=t('sign_up_page_password_confirm_hint')

    = render layout: 'field_wrapper', locals: { pt: 'pt-3' } do
      = f.submit t('sign_up_page_submit_create'), class: 'btn btn-primary'

    = render 'devise/shared/links'
