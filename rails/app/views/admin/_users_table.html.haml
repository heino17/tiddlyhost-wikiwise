%thead
  %tr
    %th= sort_link t('admin.tab_users_table_headers.th_id'), :asc
    %th= sort_link t('admin.tab_users_table_headers.th_name'), :asc
    %th= sort_link t('admin.tab_users_table_headers.th_username'), :asc
    %th= sort_link t('admin.tab_users_table_headers.th_email'), :asc
    %th= sort_link t('admin.tab_users_table_headers.th_av')
    %th= sort_link t('admin.tab_users_table_headers.th_type')
    %th= sort_link t('admin.tab_users_table_headers.th_subscription'), :asc
    %th= sort_link t('admin.tab_users_table_headers.th_logins')
    %th= sort_link t('admin.tab_users_table_headers.th_sites')
    - if Settings.tiddlyspot_enabled?
      %th= sort_link t('admin.tab_users_table_headers.th_tspot_sites')
    %th= sort_link t('admin.tab_users_table_headers.th_current_sign_in')
    %th= sort_link t('admin.tab_users_table_headers.th_last_sign_in')
    %th= sort_link t('admin.tab_users_table_headers.th_created')
    %th= sort_link t('admin.tab_users_table_headers.th_confirmed')

%tbody
  - records.each do |user|
    %tr
      %td= user.id
      %td= link_to_user(user.name, user)
      %td= link_to_user(user.username, user)
      %td= link_to_user(user.email, user)
      %td
        - if user.use_avatar?
          = avatar_image(user, size: 18)
      %td= user.user_type.name
      %td= plan_name_with_indicator(user)
      %td= user.sign_in_count
      %td= link_to_user_sites(pluralize(user.sites.count, t('admin.tabs_header.sites')), user, action: :sites)
      - if Settings.tiddlyspot_enabled?
        %td= link_to_user_sites(pluralize(user.tspot_sites.count, 'tspot'), user, action: :tspot_sites)
      %td= nice_timestamp user.current_sign_in_at
      %td= nice_timestamp user.last_sign_in_at
      %td= nice_timestamp user.created_at
      -# Show the timespan since it is more interesting than the raw timestamp
      %td= nice_timespan(user.created_at, user.confirmed_at)
